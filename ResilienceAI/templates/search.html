{% extends 'base-body.html' %}

{% load static %}

{% load custom_filters %}

{% block content %}
<div class="container">
    <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4">Search results:</p>
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
    {% if search %}
    <p class="text-center h3 mb-5 mx-1 mx-md-4 mt-4">Files:</p>
    <ul>
        {% if files %}
        <table class="table align-middle mb-0 bg-white">
            <thead>
                <tr>
                <th>Name</th>
                <th>File</th>
                <th>Owner</th>
                <th>Last Action</th>
                </tr>
            </thead>
                <tbody>        
                    {% for file in files %}
                <tr class="clickable-row" data-href="{{ file.get_absolute_url }}">
    
                    <td>
                    <div class="d-flex align-items-center">
                        <div class="ms-3">
                            <a href="{{ file.get_absolute_url }}">
                                <p class="fw-bold mb-1">{{ file.fileName }}</p>
                            </a>
                        </div>
                    </div>
                    </td>
        
                    <td>
                        <p class="fw-normal mb-1">{{ names|get_item:forloop.counter0 }}</p>
                    </td>
                    <td>
                        <p class="fw-normal mb-1">{{ file.user}}</p>
                    </td>
                    <td>{{ file.timestamp}}</td>
                </tr>  
                {% endfor %}
                </tbody>      
        </table>
        {% else %}
        <p class="text-center fw-normal  mb-5 mx-1 mx-md-4 mt-4">No files found.</p>
        {% endif %}
    </ul>
    <p class="text-center h3 mb-5 mx-1 mx-md-4 mt-4">Chats:</p>
    <ul>
        {% if chats %}
        <table class="table align-middle mb-0 bg-white">
            <thead>
                <tr>
                <th>Name</th>
                <th>Owner</th>
                <th>Last Action</th>
                </tr>
            </thead>
                <tbody>        
                    {% for chat in chats %}
                <tr class="clickable-row" data-href="{{ chat.get_absolute_url }}">

                    <td>
                    <div class="d-flex align-items-center">
                        <div class="ms-3">
                            <a href="{{ chat.get_absolute_url }}">
                                <p class="fw-bold mb-1">{{ chat.chatName }}</p>
                            </a>
                        </div>
                    </div>
                    </td>

                    <td>
                        <p class="fw-normal mb-1">{{ chat.user}}</p>
                    </td>
                    <td>{{ chat.timestamp}}</td>
                </tr>  
                {% endfor %}
                </tbody>      
        </table>
        {% else %}
        <p class="text-center fw-normal  mb-5 mx-1 mx-md-4 mt-4">No chats found.</p>
        {% endif %}
    </ul>
    {% endif %}
</div>
<script>
    $(document).ready(function(){
        $(".clickable-row").click(function() {
            window.location = $(this).data("href");
        });
    });
</script>
{% endblock %}